<% content_for :page_specific_javascript_late do %>
<script type="text/javascript"
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXGufBORq45JOUYe3Kc_bG87r-9skTr3w">
</script>

<script>
    // Note: This example requires that you consent to location sharing when
    // prompted by your browser. If you see a blank space instead of the map, this
    // is probably because you have denied permission for location sharing.

    var map;

    function initialize() {
      var mapOptions = {
        zoom: 15
      };
      map = new google.maps.Map(document.getElementById('map-canvas'),
        mapOptions);

      // Try HTML5 geolocation
      if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var pos = new google.maps.LatLng(position.coords.latitude,
           position.coords.longitude);

          var infowindow = new google.maps.InfoWindow({
            map: map,
            position: pos,
            content: "<%= t "hotels.you_are_here" %>"
          });

          map.setCenter(pos);
        }, function() {
          handleNoGeolocation(true);
        });
      } else {
        // Browser doesn't support Geolocation
        handleNoGeolocation(false);
      }
    }

    function handleNoGeolocation(errorFlag) {
      if (errorFlag) {
        var content = 'Error: The Geolocation service failed.';
      } else {
        var content = 'Error: Your browser doesn\'t support geolocation.';
      }

      var options = {
        map: map,
        position: new google.maps.LatLng(60, 105),
        content: content
      };

      var infowindow = new google.maps.InfoWindow(options);
      map.setCenter(options.position);
    }

    google.maps.event.addDomListener(window, 'load', initialize);

  </script>
  <% end %>

  <%= render :partial => "navbar" %>


  <div id="map-canvas" style="width:100%;height:450px;"></div> 

  <ul data-role="listview" data-filter="true" data-filter-placeholder="Buscar..." data-inset="true">
    <% @hotels.each do |hotel| %>
    <li >
      <a href="<%= hotel_path hotel  %>">
        <%= image_tag(hotel.hotel_photos.first.photo.thumb.url) if hotel.hotel_photos.present? %>
        <h2><%= hotel.name %></h2>
        <p><%= hotel.description.truncate(100, separator: ' ') %></p>
      </a>
    </li>
    <% end %>
  </ul>